webpackJsonp([3],{412:function(e,t,o){"use strict";function i(e){o(438)}Object.defineProperty(t,"__esModule",{value:!0});var n=o(425),s=o(439),c=o(110),a=i,r=c(n.a,s.a,!1,a,null,null);t.default=r.exports},425:function(e,t,o){"use strict";var i=o(111),n=o.n(i),s=o(112),c=o.n(s),a=o(159);t.a={name:"relationMobile",data:function(){return{accountActive:0,mobileNum:"",platSwitch:0,codeActive:0,codeImgNumber:"",CodeImgUrl:"",codeImgKey:"",msgCodeActive:0,msgNumber:"",computedTime:0,alertText:"",isGeeTestReady:!1,geeTestObj:{},cacheKey:""}},created:function(){this.cacheKey=this.$route.query.cacheKey||"",this.initCheckType()},computed:{btnDisabled:function(){var e=!1;return 0==this.platSwitch?e=!(this.mobileNum&&this.msgNumber):1==this.platSwitch?e=!(this.mobileNum&&this.codeImgNumber&&this.msgNumber):2==this.platSwitch&&(e=!(this.mobileNum&&this.isGeeTestReady&&this.msgNumber)),e},pageTitle:function(){if(customization){if("2"==customization.MPhoneNumberBinding_010)return customization.MPhoneNumberBinding_010_txt;if("1"==customization.MPhoneNumberBinding_010)return""}return"手机认证"},tipsText:function(){return customization&&"2"==customization.MPhoneNumberBinding_011?customization.MPhoneNumberBinding_011_txt:"不知道服用此药有哪些注意事项？请留下你的手机号码，便于专属药师与您联系。"},btnText:function(){return customization&&"2"==customization.MPhoneNumberBinding_012?customization.MPhoneNumberBinding_012_txt:customization&&"1"==customization.MPhoneNumberBinding_012?"":"确定"},isShowTopTips:function(){return!customization||"1"!=customization.MPhoneNumberBinding_011}},methods:{setFocuseIcon:function(e){console.log(e,this[e]),this[e]=!0,console.log(e,this[e])},sliceInp:function(){this.msgNumber.length>4&&(this.msgNumber=this.msgNumber.slice(0,4))},getImgCode:function(){var e=this;a.c.http({method:"get",url:"yywpassport/appgetpiccode"}).then(function(t){var o=t.body;if(0==o.rtn_code){var i=o.data.data;i&&(e.CodeImgUrl="data:image/jpg;base64,"+i.verifyPicStr,e.codeImgKey=i.verifyPicUuid,e.codeImgNumber="")}else e.alertText=o.rtn_tip||o.rtn_msg})},getMsgCode:function(){return common.checkMobile(this.mobileNum)?1==this.platSwitch&&4!=this.codeImgNumber.length?void(this.alertText="请输入正确的图形验证码"):(this.alertText="",void this.getMsgCodeAjax()):void(this.alertText="请输入正确的手机号码")},getMsgCodeAjax:function(e){var t=this,o={telphone:this.mobileNum,usetype:this.platSwitch,os:"h5"};1==this.platSwitch&&(o.verifypicuuid=this.codeImgKey,o.piccode=this.codeImgNumber),2==this.platSwitch&&e&&(o.geetest_challenge=e.geetest_challenge,o.geetest_seccode=e.geetest_seccode,o.geetest_validate=e.geetest_validate),a.c.http({showLoad:!1,method:"post",urlPrefix:"dev",noNetwork:!1,url:"yywpassport/customer/sendsms",params:o,_timeout:15e3}).then(function(e){var o=e.body;if(0==o.rtn_code){var i=o.data.data;o.data.successful?i&&"true"==i.issuccessful?(t.computedTime=60,t.timer=setInterval(function(){0==--t.computedTime&&clearInterval(t.timer)},1e3)):(t.alertText=i.description,t.getImgCode()):(t.showAlert=!0,1==t.platSwitch&&t.getImgCode(),t.alertText=o.data.msg)}else t.alertText=o.rtn_tip,1==t.platSwitch&&t.getImgCode()})},geeTestInit:function(){var e=this,t=this,o={glAppId:"1124"};a.c.http({method:"get",urlPrefix:"dev",url:"yywpassport/initjycaptcha",params:o,_timeout:15e3}).then(function(o){o.bodyText.promise.then(function(o){var i=JSON.parse(o);if(0!=i.rtn_code)return void(e.alertText=i.rtn_msg);var n=i.data.data;initGeetest({gt:n.gt,challenge:n.challenge,offline:!n.success,new_captcha:n.new_captcha,product:"bind",pure:0,width:"300px"},function(e){t.getMsgCode=function(){if(!common.checkMobile(t.mobileNum))return t.alertText="手机号码格式错误，请重新输入",!1;t.alertText="",e.verify()},e.onReady(function(){t.isGeeTestReady=!0}),e.onError(function(t){e.reset(),"error_12"!=t.error_code&&"error_01"!=t.error_code&&common.submitError({logCode:"YYWE00003",reportInfo:{},logType:"error",reportTitle:"极验接口打盹。"+c()(t)})}),e.onClose(function(){}),e.onSuccess(function(){var o=e.getValidate();if(!o)return t.alertText="请先滑动滑块完成拼图验证",!1;t.alertText="",t.tempGeeParams=o,t.getMsgCodeAjax(o)})})})},function(e){})},initCheckType:function(){var e=this;a.c.http({method:"get",url:"yywpassport/appverifyswithch"}).then(function(t){var o=t.body;if(0==o.rtn_code){var i=o.data.data;if(i){if(e.platSwitch=i.verifySwtichStatus,1==e.platSwitch)return void e.getImgCode();if(2==e.platSwitch)return void e.geeTestInit()}}else e.alertText=o.rtn_tip||o.rtn_msg})},bindUserPhoneNum:function(){var e=this;a.c.http({method:"post",url:"interfaces/jointLogin/h5/bingdingMobile/Baidu",urlPrefix:"passport",params:{bindMobile:this.mobileNum,smsCode:this.msgNumber,cacheKey:this.cacheKey}}).then(function(t){var o=t.body;if(o.successful){common.cookie("agree_status","1",5);var i=o.data,n=customization&&"3"==customization.channelId?1:7;for(var s in i)"newtoken"==s&&"returnUrl"==s||(""!==i[s]?common.cookie(s,i[s],n):common.cookie(s,i[s],-1));var c=common.cookie("itemurl");c&&(c=decodeURIComponent(c)),e.syncart(i,o.data.returnUrl||c||"//m.111.com.cn")}else e.alertText=o.msg},function(t){console.log(t),e.alertText=t.msg||"服务器打盹，请稍后重试~"})},syncart:function(e,t){var o={};e&&(o.token=e.newtoken);var i=[];common.cookie("cartkey")&&i.push(a.c.http({showLoad:!1,method:"get",urlPrefix:"dev",noNetwork:!1,url:"shoppingcart/syncart",params:o,_timeout:15e3}));var s=null,c="1"==this.$route.query.healthGiftMark;i.push(a.c.http({method:"post",urlPrefix:"dev",url:"coupon/healthCeremonyLayer",params:{device_id:common.cookie("UUID")||"",token:common.cookie("gltoken")},_timeout:15e3})),s=i.length-1,n.a.all(i).then(function(e){customization&&"0"==customization.Common_041&&null!=s&&e[s]&&0==e[s].body.rtn_code?e[s].body.data.isLimitUse?(common.msgShow("登录成功，恭喜获得“健康礼包” <br> 请在“我的-优惠券”中查看"),setTimeout(function(){window.location.replace("//m.111.com.cn/yyw/wap/personalcenter/#/coupon")},2e3)):(c&&common.msgShow("登录成功，您已领过“健康礼包” <br> 请在“我的-优惠券”中查看"),setTimeout(function(){window.location.replace(decodeURIComponent(t||"//m.111.com.cn"))},2e3)):window.location.replace(decodeURIComponent(t||"//m.111.com.cn"))})}}}},438:function(e,t){},439:function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("header",{staticClass:"bar bar_nav white-bg"},[o("a",{staticClass:"top_icon icon_back fl",attrs:{href:"javascript:;"},on:{click:function(t){e.$router.go(-1)}}},[o("i",{staticClass:"icon iconfont icon_leftarrow"})]),e._v(" "),o("div",{staticClass:"top_title"},[e._v(e._s(e.pageTitle))])]),e._v(" "),o("div",{staticClass:"relation-mobile-page"},[o("div",{staticClass:"content"},[e.isShowTopTips?o("p",{staticClass:"top-tips"},[o("span",[e._v("*")]),e._v("\n        "+e._s(e.tipsText)+"\n      ")]):e._e(),e._v(" "),o("div",{staticClass:"item_control"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.mobileNum,expression:"mobileNum"}],staticClass:"item_input",attrs:{type:"text",placeholder:"请输入手机号",maxlength:"11"},domProps:{value:e.mobileNum},on:{focus:function(t){e.accountActive=1},blur:function(t){e.accountActive=0},input:function(t){t.target.composing||(e.mobileNum=t.target.value)}}}),e._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:e.accountActive&&e.mobileNum,expression:"accountActive && mobileNum"}],staticClass:"icon_clear show",on:{click:function(t){e.mobileNum=""}}})]),e._v(" "),1==e.platSwitch?o("div",{staticClass:"item_control"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.codeImgNumber,expression:"codeImgNumber"}],staticClass:"item_input img_code",attrs:{type:"number",maxlength:"4",placeholder:"请输入图片验证码",autocomplete:"off"},domProps:{value:e.codeImgNumber},on:{focus:function(t){e.codeActive=1},blur:function(t){e.codeActive=0},input:function(t){t.target.composing||(e.codeImgNumber=t.target.value)}}}),e._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:e.codeImgNumber&&e.codeActive,expression:"codeImgNumber && codeActive"}],staticClass:"icon_clear show",on:{click:function(t){e.codeImgNumber=""}}}),e._v(" "),o("div",{staticClass:"code_box",on:{click:e.getImgCode}},[o("img",{attrs:{src:e.CodeImgUrl}})])]):e._e(),e._v(" "),o("div",{staticClass:"item_control w156 inlb"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.msgNumber,expression:"msgNumber"}],staticClass:"item_input msg_code",attrs:{type:"number",placeholder:"请输入验证码",autocomplete:"off",maxlength:"4"},domProps:{value:e.msgNumber},on:{input:[function(t){t.target.composing||(e.msgNumber=t.target.value)},e.sliceInp],focus:function(t){e.msgCodeActive=1},blur:function(t){e.msgCodeActive=0}}}),e._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:e.msgNumber&&e.msgCodeActive,expression:"msgNumber && msgCodeActive"}],staticClass:"icon_clear show",on:{click:function(t){e.msgNumber=""}}})]),e._v(" "),o("div",{staticClass:"msg-btn-wrapp"},[o("button",{directives:[{name:"show",rawName:"v-show",value:!e.computedTime,expression:"!computedTime"}],staticClass:"btn_code",attrs:{disabled:2==e.platSwitch&&!e.isGeeTestReady},on:{click:function(t){return t.preventDefault(),e.getMsgCode(t)}}},[e._v("获取验证码")]),e._v(" "),o("button",{directives:[{name:"show",rawName:"v-show",value:e.computedTime,expression:"computedTime"}],staticClass:"btn_code"},[e._v("重发("+e._s(e.computedTime)+"s)")])]),e._v(" "),e.alertText?o("div",{staticClass:"item_tips"},[o("p",[e._v(e._s(e.alertText))])]):e._e(),e._v(" "),o("button",{staticClass:"relation-mobile-btn",attrs:{disabled:e.btnDisabled},on:{click:e.bindUserPhoneNum}},[e._v(e._s(e.btnText))])])])])},n=[],s={render:i,staticRenderFns:n};t.a=s}});